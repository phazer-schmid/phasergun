<div class="bg-white rounded-lg shadow-md p-6">
  <h2 class="text-xl font-semibold text-gray-800 mb-4">
    Source Folder Analysis
  </h2>
  
  <form (ngSubmit)="handleSubmit()" class="space-y-4">
    <div>
      <label 
        for="sourceType" 
        class="block text-sm font-medium text-gray-700 mb-2"
      >
        File Source
      </label>
      <select
        id="sourceType"
        [(ngModel)]="selectedSource"
        name="sourceType"
        (change)="onSourceChange()"
        class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white"
        [disabled]="isProcessing"
      >
        <option *ngFor="let source of fileSources" [value]="source.value">
          {{ source.icon }} {{ source.label }}
        </option>
      </select>
      <p class="mt-1 text-sm text-gray-500">
        Select where your DHF documents are stored
      </p>
    </div>

    <!-- Google Drive Browse Button -->
    <div *ngIf="selectedSource === 'google-drive'">
      <label class="block text-sm font-medium text-gray-700 mb-2">
        Selected Folder
      </label>
      <div class="flex space-x-2">
        <input
          type="text"
          [value]="folderPath ? 'Folder Selected: ' + folderPath : 'No folder selected'"
          class="flex-1 px-4 py-2 border border-gray-300 rounded-md bg-gray-50"
          readonly
        />
        <button
          type="button"
          (click)="openGoogleDrivePicker()"
          class="px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors font-medium whitespace-nowrap"
          [disabled]="isProcessing"
        >
          üìÅ Browse Google Drive
        </button>
      </div>
      <p class="mt-1 text-sm text-gray-500">
        Click "Browse Google Drive" to select a folder
      </p>
    </div>

    <!-- Local Filesystem Path Input -->
    <div *ngIf="selectedSource === 'local'">
      <label 
        for="folderPath" 
        class="block text-sm font-medium text-gray-700 mb-2"
      >
        Folder Path
      </label>
      <input
        id="folderPath"
        [(ngModel)]="folderPath"
        name="folderPath"
        type="text"
        placeholder="/path/to/dhf/documents"
        class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"
        [disabled]="isProcessing"
        required
      />
      <p class="mt-1 text-sm text-gray-500">
        Enter the path to the folder containing documents to analyze
      </p>
    </div>

    <!-- Submit Button (only for local) -->
    <button
      *ngIf="selectedSource === 'local'"
      type="submit"
      [disabled]="isProcessing || !folderPath.trim()"
      class="w-full py-3 px-6 rounded-md font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed"
      [ngClass]="
        isProcessing || !folderPath.trim()
          ? 'bg-gray-300 text-gray-500'
          : 'bg-blue-600 text-white hover:bg-blue-700'
      "
    >
      {{ isProcessing ? 'Analyzing...' : 'Analyze Folder' }}
    </button>
  </form>

  <!-- Google Drive Picker Modal -->
  <app-google-drive-picker
    *ngIf="showGoogleDrivePicker"
    [isProcessing]="isProcessing"
    (folderSelected)="onGoogleDriveFolderSelected($event)"
    (cancelled)="onGoogleDrivePickerCancelled()"
  ></app-google-drive-picker>
</div>
